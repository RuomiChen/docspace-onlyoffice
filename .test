(function (window, undefined) {
  // æ’ä»¶åˆå§‹åŒ–
  window.Asc.plugin.init = function () {
    console.log("âœ… Highlight plugin ready");
  };

  // æ¥æ”¶æ¥è‡ªå¤–éƒ¨ï¼ˆReactï¼‰çš„æ¶ˆæ¯
  window.Asc.plugin.onExternalMessage = function (message) {
    if (message && message.type === "highlight") {
      const keyword = message.text?.trim();
      if (keyword) {
        highlightText(keyword);
      }
    }
  };

  function highlightText(keyword) {
    console.log("ğŸ” é«˜äº®å…³é”®è¯:", keyword);

    window.Asc.plugin.executeMethod("FindText", [keyword], function (found) {
      if (found && found.length > 0) {
        window.Asc.plugin.executeMethod("SelectText", [keyword]);
        window.Asc.plugin.executeMethod("ApplyStyle", [
          { backgroundColor: "#ffff00" },
        ]);
        console.log("âœ… å·²é«˜äº®:", keyword);
      } else {
        console.warn("æœªæ‰¾åˆ°åŒ¹é…:", keyword);
      }
    });
  }

  // æ’ä»¶é€€å‡ºï¼ˆç³»ç»ŸæŒ‰é’®ï¼‰
  window.Asc.plugin.button = function () {
    this.executeCommand("close", "");
  };
})(window, undefined);
